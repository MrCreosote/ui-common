

<html>
    <head>
        <title>KBase Data Pages</title>
        <link rel="icon" href="../common/img/KBase_favicon.ico" type="image/x-icon">

        <!-- Global KBass css -->
        <link href="../common/css/bootstrap.css" rel="stylesheet">
        <link href="../common/css/jquery.dataTables.css" rel="stylesheet">
        <link href="../common/css/landing-pages.css" rel="stylesheet">

        <!-- dependancies for KBase view (if not already included) -->
        <script src="../common/js/jquery.min.js"></script>
        <script src="../common/js/jquery.dataTables.js"></script>
        <script src="../common/js/bootstrap.js"></script>
        <script src="../common/js/jquery.cookie.min.js"></script>
        <script src="../common/js/viz/raphael-min.js"></script>
        <script src="../common/js/kbclient/fbaModelServices.js"></script>
        <script src="../common/js/kbclient/workspaceService.js"></script>
        <script src="../kbase_labs/javascript/lib/min/1.0.0/kbase-ui-min.js"></script>

        <!-- widgets -->
        <script src="../widgets/kbaseModelMeta.js"></script>
        <script src="../widgets/kbaseModelTabs.js"></script>
        <script src="../widgets/kbaseModelCore.js"></script>
        <script src="../widgets/kbaseRxnMeta.js"></script>

        <script>
            $(function() {
                $('#navigation').load('../common/templates/nav.html', function() {
                    init_page();
                })

                function init_page() {
                    //fix me
                    $('#signin-button').kbaseLogin({style: 'text', 
                        login_callback: reload_window, logout_callback: reload_window});
                    var USER_TOKEN = $("#signin-button").kbaseLogin('session').token;
                    
                    $('#model-meta').kbaseModelMeta({ids : ['kb|g.19.fbamdl.0'], 
                                                     workspaces : ['KBaseFBA'],
                                                     auth: USER_TOKEN});
                
                    $('#model-tabs').kbaseModelTabs({ids : ['kb|g.19.fbamdl.0'], 
                                                     workspaces : ['KBaseFBA'],
                                                     auth: USER_TOKEN});

                    $('#core-map').kbaseModelCore({ids : ['kb|g.19.fbamdl.0'], 
                                                   workspaces : ['KBaseFBA'],
                                                   auth: USER_TOKEN});
                    
                    var rxn_modal = $('#rxn-modal').kbaseRxnMeta({auth: USER_TOKEN});
                    
                    $(document).on("rxnClick", function(e, data) {
                        rxn_modal.show({rxns: data.rxns});
                    })

                    function reload_window() {
                        window.location.reload();
                    }
                }
            })
        </script>
    </head>

    <body>
        <div id="navigation"></div>

        <!-- start app -->
        <div class="wrapper">
            <div class="row">
                <div class="col-lg-4">
                    <div id="model-meta"></div>
                </div>
                <div class="col-lg-8">
                    <div id="model-tabs"></div>
                </div>
            </div>       

            <div class="row">
                <div class="col-lg-12">
                    <div id="core-map"></div>
                </div>
            </div>
        </div>
        <!-- end app -->

        <!-- modals -->
        <div id="rxn-modal">
        </div>

    </body>

</html>
